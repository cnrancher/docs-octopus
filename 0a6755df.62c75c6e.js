(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{139:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return c})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return p})),a.d(t,"default",(function(){return j}));var b=a(2),n=a(9),r=(a(0),a(186)),c={id:"mqtt",title:"MQTT \u9002\u914d\u5668"},l={id:"cn/adaptors/mqtt",title:"MQTT \u9002\u914d\u5668",description:"## \u6ce8\u518c\u4fe1\u606f",source:"@site/docs/cn/adaptors/mqtt.md",permalink:"/docs-octopus/docs/cn/adaptors/mqtt",editUrl:"https://github.com/cnrancher/docs-octopus/tree/master/docs/cn/adaptors/mqtt.md",sidebar:"cn-docs",previous:{title:"OPC-UA \u9002\u914d\u5668",permalink:"/docs-octopus/docs/cn/adaptors/opc-ua"},next:{title:"BLE \u9002\u914d\u5668",permalink:"/docs-octopus/docs/cn/adaptors/ble"}},p=[{value:"\u6ce8\u518c\u4fe1\u606f",id:"\u6ce8\u518c\u4fe1\u606f",children:[]},{value:"\u652f\u6301\u6a21\u677f",id:"\u652f\u6301\u6a21\u677f",children:[]},{value:"\u652f\u6301\u7684\u5e73\u53f0",id:"\u652f\u6301\u7684\u5e73\u53f0",children:[]},{value:"\u4f7f\u7528\u65b9\u5f0f",id:"\u4f7f\u7528\u65b9\u5f0f",children:[]},{value:"\u6743\u9650",id:"\u6743\u9650",children:[{value:"DeviceSpecProperty",id:"devicespecproperty",children:[]},{value:"DevicePropertyStatus",id:"devicepropertystatus",children:[]},{value:"MQTT\u53c2\u6570",id:"mqtt\u53c2\u6570",children:[]},{value:"PubInfo",id:"pubinfo",children:[]},{value:"SubInfo",id:"subinfo",children:[]},{value:"ValueProps",id:"valueprops",children:[]}]},{value:"MQTT deviceLink YAML\u793a\u4f8b",id:"mqtt-devicelink-yaml\u793a\u4f8b",children:[{value:"JSON Path\u8bed\u6cd5",id:"json-path\u8bed\u6cd5",children:[]},{value:"\u5feb\u901f\u5165\u95e8",id:"\u5feb\u901f\u5165\u95e8",children:[]}]}],i={rightToc:p};function j(e){var t=e.components,a=Object(n.a)(e,["components"]);return Object(r.b)("wrapper",Object(b.a)({},i,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h2",{id:"\u6ce8\u518c\u4fe1\u606f"},"\u6ce8\u518c\u4fe1\u606f"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7248\u672c"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u6ce8\u518c\u540d\u79f0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7aef\u70b9 Socket"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u53ef\u7528"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"v1alpha1")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"adaptors.edge.cattle.io/mqtt")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"mqtt.sock")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h2",{id:"\u652f\u6301\u6a21\u677f"},"\u652f\u6301\u6a21\u677f"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u8bbe\u5907\u7ec4"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7248\u672c"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u53ef\u7528"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"mqttDevice")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"devices.edge.cattle.io")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"v1alpha1")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h2",{id:"\u652f\u6301\u7684\u5e73\u53f0"},"\u652f\u6301\u7684\u5e73\u53f0"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u64cd\u4f5c\u7cfb\u7edf"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u67b6\u6784"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"linux")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"amd64"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"linux")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"arm"))),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"linux")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("inlineCode",{parentName:"td"},"arm64"))))),Object(r.b)("h2",{id:"\u4f7f\u7528\u65b9\u5f0f"},"\u4f7f\u7528\u65b9\u5f0f"),Object(r.b)("pre",null,Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),"kubectl apply -f https://raw.githubusercontent.com/cnrancher/octopus/master/adaptors/opcua/deploy/e2e/all_in_one.yaml\n")),Object(r.b)("h2",{id:"\u6743\u9650"},"\u6743\u9650"),Object(r.b)("p",null,"\u5bf9Octopus\u6388\u4e88\u6743\u9650\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),Object(r.b)("pre",null,Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-text"}),"  Resources                                   Non-Resource URLs  Resource Names  Verbs\n  ---------                                   -----------------  --------------  -----\n  mqttdevices.devices.edge.cattle.io         []                 []              [create delete get list patch update watch]\n  mqttdevices.devices.edge.cattle.io/status  []                 []              [get patch update]\n")),Object(r.b)("h3",{id:"devicespecproperty"},"DeviceSpecProperty"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"name"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5c5e\u6027\u540d\u79f0"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"description"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5c5e\u6027\u63cf\u8ff0"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"jsonPath"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5c5e\u6027\u503c\u7684json\u8def\u5f84\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003",Object(r.b)("a",Object(b.a)({parentName:"td"},{href:"https://github.com/tidwall/gjson/blob/master/SYNTAX.md"}),"GJSON Syntax")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"subInfo"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u8ba2\u9605\u4fe1\u606fadapter"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(b.a)({parentName:"td"},{href:"#subinfo"}),"SubInfo")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"value"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5c5e\u6027\u7684valueProps"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(b.a)({parentName:"td"},{href:"#valueprops"}),"ValueProps")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")))),Object(r.b)("h3",{id:"devicepropertystatus"},"DevicePropertyStatus"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"name"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"property name"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"description"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"property describe"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"value"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"valueProps of property"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),Object(r.b)("a",Object(b.a)({parentName:"td"},{href:"#valueprops"}),"ValueProps")),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"updateAt"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"property status update time"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h3",{id:"mqtt\u53c2\u6570"},"MQTT\u53c2\u6570"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"broker"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT broker url\u5730\u5740"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"username"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT \u7528\u6237\u540d"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"password"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT \u7528\u6237\u5bc6\u7801"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h3",{id:"pubinfo"},"PubInfo"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"topic"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"topic\u540d\u79f0"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"qos"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT\u670d\u52a1\u8d28\u91cf\u7b49\u7ea7"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"int"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h3",{id:"subinfo"},"SubInfo"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"topic"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"topic\u540d\u79f0"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"payloadType"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT payload \u7c7b\u578b\uff08json\uff09"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"qos"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"MQTT\u670d\u52a1\u8d28\u91cf\u7b49\u7ea7"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"int"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f")))),Object(r.b)("h3",{id:"valueprops"},"ValueProps"),Object(r.b)("table",null,Object(r.b)("thead",{parentName:"table"},Object(r.b)("tr",{parentName:"thead"},Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u53c2\u6570"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u63cf\u8ff0"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u7c7b\u578b"),Object(r.b)("th",Object(b.a)({parentName:"tr"},{align:"left"}),"\u662f\u5426\u5fc5\u586b"))),Object(r.b)("tbody",{parentName:"table"},Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"valueType"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5c5e\u6027\u7c7b\u578b\uff0c\u53ef\u9009\u503c\u5305\u62ec\uff1aint\u3001string\u3001float\u3001boolean\u3001array\u548cobject"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"intValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"int\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"int"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"stringValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"string"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"floatValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"float\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"float"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"booleanValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"boolean\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"boolean"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"arrayValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"array\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"RawExtension"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")),Object(r.b)("tr",{parentName:"tbody"},Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"objectValue"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"object\u7c7b\u578b\u5c5e\u6027\u7684\u503c"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"RawExtension"),Object(r.b)("td",Object(b.a)({parentName:"tr"},{align:"left"}),"\u5426")))),Object(r.b)("h2",{id:"mqtt-devicelink-yaml\u793a\u4f8b"},"MQTT deviceLink YAML\u793a\u4f8b"),Object(r.b)("pre",null,Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-YAML"}),'apiVersion: edge.cattle.io/v1alpha1\nkind: DeviceLink\nmetadata:\n  name: mqtt-test\nspec:\n  adaptor:\n    node: k3d-k3s-default-server\n    name: adaptors.edge.cattle.io/mqtt\n    parameters:\n      syncInterval: 5\n      timeout: 10\n  model:\n    apiVersion: "devices.edge.cattle.io/v1alpha1"\n    kind: "MqttDevice"\n  template:\n    metadata:\n      labels:\n        device: mqtt-test\n    spec:\n      config:\n        broker: "tcp://192.168.8.246:1883"\n        password: p*****3\n        username: parchk\n      properties:\n        - name: "switch"\n          description: "the room light switch"\n          jsonPath: "switch"\n          subInfo:\n              topic: "device/room/light"\n              payloadType: "json"\n              qos: 2\n        - name: "brightness"\n          description: "the room light brightness"\n          jsonPath: "brightness"\n          subInfo:\n              topic: "device/room/light"\n              payloadType: "json"\n              qos: 2\n        - name: "power"\n          description: "the room light power"\n          jsonPath: "power"\n          subInfo:\n              topic: "device/room/light"\n              payloadType: "json"\n              qos: 2\n\n\n')),Object(r.b)("h3",{id:"json-path\u8bed\u6cd5"},"JSON Path\u8bed\u6cd5"),Object(r.b)("p",null,"\u5c5e\u6027\u503c\u7684json\u8def\u5f84\uff0c\u8be6\u60c5\u8bf7\u53c2\u8003",Object(r.b)("a",Object(b.a)({parentName:"p"},{href:"https://github.com/tidwall/gjson/blob/master/SYNTAX.md"}),"GJSON Syntax")),Object(r.b)("h3",{id:"\u5feb\u901f\u5165\u95e8"},"\u5feb\u901f\u5165\u95e8"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u66f4\u65b0\u4e0a\u8ff0",Object(r.b)("a",Object(b.a)({parentName:"p"},{href:"#example-of-mqtt-devicelink-yaml"}),"YAML"),"\u6587\u4ef6\u793a\u4f8b\u4e2d\u7684MQTT broker\u53c2\u6570\u914d\u7f6e"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-yaml"}),'    spec:\n      config:\n        broker: "tcp://192.168.8.246:1883"\n        password: p*****3\n        username: parchk\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u542f\u52a8",Object(r.b)("inlineCode",{parentName:"p"},"test/testdata/testdevice/roomlight"),"\u8def\u5f84\u4e0b\u7684roomlight\u8bbe\u5907"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),'cd ./testdata/testdevice/roomlight\ngo build\n./roomlight -b "tcp://192.168.8.246:1883"\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u4f7f\u7528",Object(r.b)("a",Object(b.a)({parentName:"p"},{href:"https://github.com/cnrancher/octopus/tree/master/deploy/e2e"}),Object(r.b)("inlineCode",{parentName:"a"},"deploy/e2e")),"\u90e8\u7f72DeviceLink"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),"$ kubeclt apply -f roomlightcase1.yaml\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u68c0\u67e5\u96c6\u7fa4\u4e2d\u8bbe\u5907\u7684\u72b6\u6001"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),"$ kubeclt get mqttdevice mqtt-test -oyaml\n"))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u5982\u679c\u5b89\u88c5\u6210\u529f\uff0c\u5e94\u8be5\u8fd4\u56de\u5982\u4e0b\u4fe1\u606f\uff1a"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-yaml"}),'apiVersion: "devices.edge.cattle.io/v1alpha1"\nkind: "MqttDevice"\nmetadata: \n  creationTimestamp: \n  name: "testDevice"\nspec: \n  config: \n    broker: ""\n    password: ""\n    username: ""\n  properties: \n  - description: "test property"\n    jsonPath: "power"\n    name: "test_property"\n    pubInfo: \n      qos: "0"\n      topic: ""\n    subInfo: \n      payloadType: "json"\n      qos: "2"\n      topic: "test/abc"\n    value: \n      valueType: ""\nstatus: \n  properties: \n  - description: "test property"\n    name: "test_property"\n    updateAt: "2020-05-20T09:04:46Z"\n    value: \n      objectValue: \n        electricQuantity: "19.99"\n        powerDissipation: "10KWH"\n      valueType: "object"\n'))),Object(r.b)("li",{parentName:"ol"},Object(r.b)("p",{parentName:"li"},"\u60a8\u53ef\u4ee5\u4fee\u6539\u8bbe\u5907\u5c5e\u6027\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-shell",metastring:"script",script:!0}),"$ kubectl edit dl mqtt-test\n")),Object(r.b)("pre",{parentName:"li"},Object(r.b)("code",Object(b.a)({parentName:"pre"},{className:"language-yaml"}),'    spec:\n      config:\n        broker: tcp://192.168.8.246:1883\n        password: p*****3\n        username: parchk\n      properties:\n      - description: the room light switch\n        jsonPath: switch\n        name: switch\n        subInfo:\n          payloadType: json\n          qos: 2\n          topic: device/room/light\n        value:\n          stringValue: "on"\n          valueType: string\n')))))}j.isMDXComponent=!0},186:function(e,t,a){"use strict";a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return d}));var b=a(0),n=a.n(b);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);t&&(b=b.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,b)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function p(e,t){if(null==e)return{};var a,b,n=function(e,t){if(null==e)return{};var a,b,n={},r=Object.keys(e);for(b=0;b<r.length;b++)a=r[b],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(b=0;b<r.length;b++)a=r[b],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var i=n.a.createContext({}),j=function(e){var t=n.a.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l({},t,{},e)),a},O=function(e){var t=j(e.components);return n.a.createElement(i.Provider,{value:t},e.children)},o={inlineCode:"code",wrapper:function(e){var t=e.children;return n.a.createElement(n.a.Fragment,{},t)}},m=Object(b.forwardRef)((function(e,t){var a=e.components,b=e.mdxType,r=e.originalType,c=e.parentName,i=p(e,["components","mdxType","originalType","parentName"]),O=j(a),m=b,d=O["".concat(c,".").concat(m)]||O[m]||o[m]||r;return a?n.a.createElement(d,l({ref:t},i,{components:a})):n.a.createElement(d,l({ref:t},i))}));function d(e,t){var a=arguments,b=t&&t.mdxType;if("string"==typeof e||b){var r=a.length,c=new Array(r);c[0]=m;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:b,c[1]=l;for(var i=2;i<r;i++)c[i]=a[i];return n.a.createElement.apply(null,c)}return n.a.createElement.apply(null,a)}m.displayName="MDXCreateElement"}}]);